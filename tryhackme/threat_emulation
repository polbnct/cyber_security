What is threat Emulation?

- Threat Emulation is meant to assist security teams and organisations, in general, in better understanding their security posture and their defence mechanisms and performing due diligence in their compliance.

Cyber Security Assessment Issues;

-- Are our people traned and alert?
-- Are our internal processes effective?
-- has the technology in use properly configure and delivered value to the business?

Vulnerability Assessments - Are conducted to identify vulnerabilities in assets under a defined sccope.

Focus -- Comprehensive and based on the rulse of the engagement defined, as assessments do not include exploitation.

Penentration Testing - involves exploiting vulnerabilities within an organisation under strict control of the scopr and rules of engagement.

Pentest - provide oraganisations with information about their security posture, patching vulnerabilities and where to invest in security training or practices.

Red teaming - provides a means of looking at cyber security issues from an adversary's perspective. 

Threat Emulation - is an intelligence-driven impersonatinon of real-world attack scenarios and TTPs in controlled environment to test, assess and improve an organisation;s security defences and response capabilities.

Real-world threats - The MITRE ATT&CK framework and cyber threat intelligence are common information sources to ensure threat TTPs are based on actual breaches, APTs and campaigns

Behaviour-focused - The execution of TTPs during an emulation exercise aims to tune defences based on behaviours and not signatures, thus adapting to the elements of the Pyramid.

Transparency - Disclosure of activities between the Red and Blue teams during execution ensures that the security posture is improved holistically.

Collaborative - due to common goal of improving organisational security, threat emulations allows team to collaborate in their efforts.

Repeatable - Some emulation tasks would bedone multiple times in the course on an exercise or numerious exercises.

Assessment & Improvement - The goal is to test personnel, assess security processes and evaluate the technology adopted.

Capability Development - Emulation enable the creation, modificaaiton and application of tools and analytics derived from TTPs

Professional Development - This breaks down the barriers between red and blue teams and fosters collaboration missions.

Emulation Methodologies;

Mitre ATT&ck framework;
- is an industry-known knowledge base that provides information about knonw adversarial TTPs observed in actual attacks and breaches.

The Atomic Red Team - is a library of emulation tests developed and curated by Red Canary that can be executed to test security defences within an organisation.

Choose an ATT&CK technique -> Choose a test for that techniques -> Execute the test procedure -> Analyse your detections of the procedures -> Make improvements to your defense.

TIBER-EU Framework
- The Threat Intelligence-based Ethical Red Teaming is the European Framework developed to deliver controlled, bespoke, intelligence-led emulation testing on entities and organisations' critical live systems.
(like purple teaming)

Three phase of TIBER-EU Framework;

1. Preparation Phase;
- During these phase, the security teams involved in the test are established, and the entity's management determines and approves the socpe.  this represents the formal launch of adversarial testing by endusring all the planning and procurement processes are fulfilled.

2. Testing Phase;
- During this phase, the security teams involved in the test are established, and the entity's management determines and approves the scope. This represents the formal launch of adversarial testing by ensuring all the planning and procurement processes are fullfilled.

3. Closure Phase; 
- Once the tests are run and defense measured, the emulation team must consider reporting and remediation measures. Each group will draft their analysis reports, including details of the test conducted, finding and recommendations for technical controls, policies, procedures, and awareness training.

CITD (Center for Threat Informed Defense)
- Non-profit research and development organisation operated by MITRE Engenuity. Its misison is to promote the practice of threat informed defence.
- Curated open source adversary emulation library.

2 Approaches on their emulation;

Full Emulation;
- This is a comprehensive approach to emulating a particular adversary.

Micro Emulation;
- This approac is more focused, emulating behaviours accross multiple adversaryes, such as file access or process injection techniques.

Threat Emulation Process 1:

1. Defining Emulation Objectives;
- Defining clear, well defined, specific, and measurable objectives.
- The scope of the exercise should also be clearly defined, including what the emulation will target as specific systems and data.

2. Research Adversary TTPs
- This step aims to accurately model the behaviour of the target adversary so that the emulation team can conduct the exercise realistically and practically.
- Involves gathering as much information about the threat and identifying its behaviours

2.1 - Information Gathering
- This step starts by gathering information about threats you would be concerned about.
- APT41 -- Deals with cyber espionage as opposed to financial fraud.

2.2 - Select the Emulated Adversary
- Relevance;
Align adversary to be selected to the engagement objectives and the company's goals. This may even include looking at the grographical relevance of particular APTs
- Available CTI;
Threat intelligence is vital for providing trustworthy information about threat.-- reliable resources around the TTPs

- TTP Complexity;
Executing a fruitful emulation plan for complex adversaries who use sophisticated tools and procedures may take a long time.
-- Establing whether existing tools can handle the emulatioin or whether cusoms one are required.

- Available Resources;
Theese are primarily in-house resources that must be provisioned for a smootyh opration. Budget, time and personnel must be allocated appropriately during the emulation process.

Emulation Engineer;
- Reviews the factors of the attack, assessing the shortlist of TTPs against them and narrowing down to the appropriate selection.

2.3 Select the emulated TTPs
- Aims to accurately model the behaviour of the target adversary so that the exercise can be conducted realistically and practically.
-- FIN7 APT, TTPs include spear phishing, social engineering, and watering hole attacks.

2.4 Construct TTP Outline;
- The outline aims to drive follow-up threat emulation activities, such as explaining the planned emulation activities, stating the scope and rules of engagement and how the TTPs will be implemented during the exercise.

Threat Emulation Process II;

Threat Emulation Plans - Are a collection of resources used to organise and set a step-by-step execution of instructions for adversary behaviours based on a particular set of TTPs.

- Engagement Objective - Objective in the beginning of the process to understand the threat emulation.

- Scope - The departments, users and devices upon which emulation activities are permitted should be defined explicitly.

- Schedule - The dates and times when the activities should occur and wen deliverables are due should be defined.

- Rules of Engagement - The acceptable adversary behaviours to be emulated must be planned and discussed.

- Permission to Execute - Explicit written consent to conduct the emulation activities must be provided by sufficient authority from the organisation.

- Communication Plan - The Emulation team and organisation stakeholders must have a plan to communicate information concerning the emulation activities.

Conducting the Emulation;
- Involves carrying out the attack using the TTPs identified in research phase. 

Planning the Deployment;
- As the emulation engineer for VASEPY, we can revisit the Research phase tackled in the previous task, where we identify the TTPs to emulate for FIN7

Implementation of TTP;
- This is where the deployment of actual TTPs happens. In our case scenario, an initial access payload for FIN7 would be created and obfuscated using an RTF document, delivered through a spear phishing email.

Detections & Mitigations;

- Since Emulation is a cross team and collaborative endeavour, the defence team must find ways to detect and mitigate against emulated TTPs.
- SOC usually uses standard cyber security tools to collect, correlate and analyse TTP behaviour and logs for detection.
- MITRE provides a list of mitigation efforts for the adversarial TTPs, and this can be provided as recommendations as implemented as part of the emulation.




